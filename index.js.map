{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '45630134-be2c900d0fa84b494dc62f217';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet currentPage = 1;\nlet currentQuery = '';\nexport const perPage = 15;\n\nexport async function fetchImages(query, page = 1) {\n  if (query !== currentQuery) {\n    currentPage = 1;\n    currentQuery = query;\n  } else {\n    currentPage = page;\n  }\n\n  const URL = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${perPage}&page=${currentPage}`;\n\n  try {\n    const response = await axios.get(URL);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n\nexport function incrementPage() {\n  currentPage += 1;\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n\nexport function getCurrentQuery() {\n  return currentQuery;\n}\n\nexport function getCurrentPage() {\n  return currentPage;\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet lightbox;\n\nexport function renderGallery(images) {\n  const gallery = document.querySelector('.gallery');\n\n  \n  const markup = images.map(image => {\n    return `\n      <div class=\"photo-card\">\n        <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b> ${image.likes}\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b> ${image.views}\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b> ${image.comments}\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b> ${image.downloads}\n          </p>\n        </div>\n      </div>\n    `;\n  }).join('');\n\n  \n  gallery.insertAdjacentHTML('beforeend', markup);\n\n \n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n  }\n}\nexport function showLoader() {\n  document.querySelector('.loader').classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  document.querySelector('.loader').classList.add('hidden');\n}\n\n\nexport function showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n  });\n}\n\nexport function showInfo(message) {\n  iziToast.info({\n    title: 'Info',\n    message: message,\n  });\n}","import { fetchImages, incrementPage, resetPage, getCurrentQuery, getCurrentPage, perPage } from './js/pixabay-api.js';\nimport { renderGallery, showLoader, hideLoader, showError } from './js/render-functions.js';\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  const form = document.getElementById('search-form');\n  const gallery = document.querySelector('.gallery');\n  const loadMoreBtn = document.querySelector('.load-more');\n\n  let totalPages = 0;\n\n  form.addEventListener('submit', async function(event) {\n    event.preventDefault();\n    const query = form.querySelector('input[name=\"searchQuery\"]').value.trim();\n\n    if (query === '') {\n      showError('Please enter a search query.');\n      return;\n    }\n\n    showLoader(); \n    resetPage(); \n    gallery.innerHTML = '';\n    loadMoreBtn.style.display = 'none'; \n\n    try {\n      const data = await fetchImages(query);\n      hideLoader(); \n\n      if (data.totalHits > 0) {\n        renderGallery(data.hits);\n\n        \n        totalPages = Math.ceil(data.totalHits / perPage);\n\n        \n        if (data.totalHits % perPage === 0) {\n          totalPages -= 1;\n        }\n\n        \n        if (totalPages > 1) {\n          loadMoreBtn.style.display = 'block';\n        }\n      } else {\n        showError('Sorry, there are no images matching your search query. Please try again!');\n      }\n    } catch (error) {\n      hideLoader(); \n      showError('An error occurred while fetching images.');\n    } finally {\n      form.reset();\n    }\n  });\n\n  loadMoreBtn.addEventListener('click', async function() {\n    const currentPage = getCurrentPage();\n\n    if (currentPage >= totalPages) {\n      \n      loadMoreBtn.style.display = 'none';\n      showError(\"We're sorry, but you've reached the end of search results.\");\n      return;\n    }\n\n    incrementPage(); \n    showLoader(); \n    loadMoreBtn.style.display = 'none'; \n\n    try {\n      const data = await fetchImages(getCurrentQuery(), currentPage + 1);\n      hideLoader(); \n      renderGallery(data.hits);\n\n      if (currentPage + 1 >= totalPages) {\n        loadMoreBtn.style.display = 'none';\n        showError(\"We're sorry, but you've reached the end of search results.\");\n      } else {\n        loadMoreBtn.style.display = 'block'; \n      }\n    } catch (error) {\n      hideLoader(); \n      loadMoreBtn.style.display = 'block'; \n      showError('An error occurred while fetching more images.');\n    }\n  });\n});"],"names":["API_KEY","BASE_URL","currentPage","currentQuery","perPage","fetchImages","query","page","URL","axios","error","incrementPage","resetPage","getCurrentQuery","getCurrentPage","lightbox","renderGallery","images","gallery","markup","image","SimpleLightbox","showLoader","hideLoader","showError","message","iziToast","form","loadMoreBtn","totalPages","event","data"],"mappings":"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"}